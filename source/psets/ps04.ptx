<?xml version="1.0" encoding="UTF-8"?>
<pretext xmlns:xi="http://www.w3.org/2001/XInclude">
  <article>
    <section xml:id="ps04-section">
      <title>Problem Set 4</title>
      <subtitle>Approximate Integration and Improper Integrals</subtitle>
      <xi:include href="ps03.ptx" xpointer="xpointer(//section[1]/introduction)" />
      <exercises>
        <exercise xml:id="ex-simpsons-rule-revised">
          <statement>
            <p> Use Simpson's Rule with <m>n=4</m> to approximate the definite integral <m>\int_0^4
              \frac{1}{1+x^2} \,dx</m>. </p>
          </statement>
          <solution>
            <p> The formula for Simpson's Rule with <m>n</m> subintervals is: <me>
                S_n = \frac{\Delta x}{3} [f(x_0) + 4f(x_1) + 2f(x_2) + \dots + 4f(x_{n-1}) + f(x_n)]
              </me>
              For our problem, <m>a=0</m>, <m>b=4</m>, and <m>n=4</m>. <me>
                \Delta x = \frac{b-a}{n} = \frac{4-0}{4} = 1
              </me> The
              partition points are <m>x_0=0, x_1=1, x_2=2, x_3=3, x_4=4</m>. Now we calculate the
              function values at these points: <me>
                f(x) = \frac{1}{1+x^2}
              </me>
              <md>
                <mrow>f(0) \amp = \frac{1}{1+0^2} = 1</mrow>
                <mrow>f(1) \amp = \frac{1}{1+1^2} = \frac{1}{2}</mrow>
                <mrow>f(2) \amp = \frac{1}{1+2^2} = \frac{1}{5}</mrow>
                <mrow>f(3) \amp = \frac{1}{1+3^2} = \frac{1}{10}</mrow>
                <mrow>f(4) \amp = \frac{1}{1+4^2} = \frac{1}{17}</mrow>
              </md> Now, we
              apply Simpson's Rule: </p>
            <md>
              <mrow>S_4 \amp = \frac{1}{3} [f(0) + 4f(1) + 2f(2) + 4f(3) + f(4)]</mrow>
              <mrow>\amp = \frac{1}{3} [1 + 4\left(\frac{1}{2}\right) + 2\left(\frac{1}{5}\right) +
                4\left(\frac{1}{10}\right) + \frac{1}{17}]</mrow>
              <mrow>\amp = \frac{1}{3} [1 + 2 + \frac{2}{5} + \frac{4}{10} + \frac{1}{17}]</mrow>
              <mrow>\amp = \frac{1}{3} [3 + \frac{4}{5} + \frac{1}{17}] = \frac{1}{3}
                [\frac{255+68+5}{85}] = \frac{328}{255} \approx 1.286</mrow>
            </md>
          </solution>
        </exercise>

        <exercise xml:id="ex-improper-integral-type-2">
          <statement>
            <p> Determine if the integral <me>\int_0^1 \frac{1}{\sqrt{x}} \,dx</me> converges or
              diverges. If it converges, find its value. </p>
          </statement>
          <solution>
            <p> This is a Type 2 improper integral because the integrand has an infinite
              discontinuity at the lower limit <m>x=0</m>. We evaluate it using a limit: <me>
              \int_0^1 \frac{1}{\sqrt{x}} \,dx = \lim_{t \to 0^+} \int_t^1 x^{-1/2} \,dx
              </me>
            </p>
            <p> First, we find the antiderivative: <me>
                \int x^{-1/2} \,dx = \frac{x^{1/2}}{1/2} = 2\sqrt{x}
              </me>
              Now we evaluate the definite integral and then the limit: </p>
            <md>
              <mrow>\int_t^1 x^{-1/2} \,dx \amp = \left[ 2\sqrt{x} \right]_t^1</mrow>
              <mrow>\amp = 2\sqrt{1} - 2\sqrt{t} = 2 - 2\sqrt{t}</mrow>
            </md>
            <p> Finally, we take the limit as <m>t \to 0^+</m>: <me>
                \lim_{t \to 0^+} (2 - 2\sqrt{t}) = 2 - 2\sqrt{0} = 2
              </me>
            </p>
            <p>
              Since the limit exists and is a finite number, the integral converges to 2.
            </p>
          </solution>
        </exercise>

        <exercise xml:id="ex-trapezoidal-rule">
          <statement>
            <p> Use the Trapezoidal Rule with <m>n=4</m> to approximate the definite integral <m>\int_0^2
              \sqrt{1+x^3} \,dx</m>. </p>
          </statement>
          <solution>
            <p> The formula for the Trapezoidal Rule with <m>n</m> subintervals is: <me>
                T_n = \frac{\Delta x}{2} [f(x_0) + 2f(x_1) + 2f(x_2) + \dots + 2f(x_{n-1}) + f(x_n)]
              </me>
              For this problem, <m>a=0</m>, <m>b=2</m>, and <m>n=4</m>. <me>
                \Delta x = \frac{b-a}{n} = \frac{2-0}{4} = 0.5
              </me>
              The partition points are <m>x_0=0, x_1=0.5, x_2=1, x_3=1.5, x_4=2</m>. Now, we
              calculate the function values at these points, rounding to four decimal places: <md>
                <mrow>f(0) \amp = \sqrt{1+0^3} = 1</mrow>
                <mrow>f(0.5) \amp = \sqrt{1+(0.5)^3} = \sqrt{1.125} \approx 1.0607</mrow>
                <mrow>f(1) \amp = \sqrt{1+1^3} = \sqrt{2} \approx 1.4142</mrow>
                <mrow>f(1.5) \amp = \sqrt{1+(1.5)^3} = \sqrt{4.375} \approx 2.0917</mrow>
                <mrow>f(2) \amp = \sqrt{1+2^3} = \sqrt{9} = 3</mrow>
              </md> Finally, we
              apply the Trapezoidal Rule: </p>
            <md>
              <mrow>T_4 \amp = \frac{0.5}{2} [f(0) + 2f(0.5) + 2f(1) + 2f(1.5) + f(2)]</mrow>
              <mrow>\amp = 0.25 [1 + 2(1.0607) + 2(1.4142) + 2(2.0917) + 3]</mrow>
              <mrow>\amp = 0.25 [1 + 2.1214 + 2.8284 + 4.1834 + 3] = 0.25 [13.1332] \approx 3.2833</mrow>
            </md>
          </solution>
        </exercise>

        <exercise xml:id="ex-improper-integral-type-1">
          <statement>
            <p> Determine if the integral <me>\int_1^\infty \frac{1}{x^3} \,dx</me> converges or
              diverges. If it converges, find its value. </p>
          </statement>
          <solution>
            <p> This is a Type 1 improper integral. We evaluate it using a limit: <me>
                \int_1^\infty \frac{1}{x^3} \,dx = \lim_{t \to \infty} \int_1^t x^{-3} \,dx
              </me>
              First, we find the antiderivative: <me>
                \int x^{-3} \,dx = \frac{x^{-2}}{-2} = -\frac{1}{2x^2}
              </me>
              Now we evaluate the definite integral and then the limit: </p>
            <md>
              <mrow>\int_1^t x^{-3} \,dx \amp = \left[ -\frac{1}{2x^2} \right]_1^t</mrow>
              <mrow>\amp = \left( -\frac{1}{2t^2} \right) - \left( -\frac{1}{2(1)^2} \right) =
                -\frac{1}{2t^2} + \frac{1}{2}</mrow>
            </md>
            <p> Finally, we take the limit as <m>t \to \infty</m>: <me>
                \lim_{t \to \infty} \left( -\frac{1}{2t^2} + \frac{1}{2} \right) = 0 + \frac{1}{2} =
              \frac{1}{2}
              </me>
            </p>
            <p> Since the limit exists and is a finite number, the integral converges to <m>
              \frac{1}{2}</m>. </p>
          </solution>
        </exercise>

        <exercise xml:id="ex-trapezoidal-midpoint-linearcombination">
          <statement>
            <p>
              When approximating any definite integral using the trapezoidal rule, midpoint rule, or Simpson's rule, 
              show that <me> \frac{1}{3} T_n + \frac{2}{3} M_n = S_{2n} </me> 
            </p>
          </statement>
          <solution>
            <p>
              Let <m>a</m> and <m>b</m> be the limits of integration, and let <m>n</m> be the number of subintervals used in the trapezoidal and midpoint rules. 
              In order to compare these to Simpson's rule, we will use <m>2n</m> subintervals, count the even-indexed partition points for the trapezoidal rule, and the odd-indexed values for the midpoint rule.            
              Then the width of each subinterval is <me> \Delta x = \frac{b-a}{2n} </me>.
              The partition points are <m>x_0, x_1, \ldots, x_{2n}</m>, where <m>x_i = a + i\Delta x</m>.
              Their values are <m>y_0 = f(x_0), y_1=f(x_1), \ldots, y_{2n} = f(x_{2n})</m>.
              When finding the trapezoidal and midpoint approximations, the intervals are <m>2\,\Delta x</m> wide,
              instead of the normal <m>\Delta x</m> width used in Simpson's rule.
              <md>
                <mrow> T_n \amp \frac{2\,\Delta x}{2}\left(y_0 + 2 y_2 + 2 y_4 + \dots + 2 y_{2n-2} + y_{2n} \right)</mrow>
                <mrow> M_n \amp (2,\Delta x) \left(y_1 + y_3 + y_5 + \dots + y_{2n-1} \right)</mrow>
              </md>
              Now we compute <m>\frac{1}{3} T_n + \frac{2}{3} M_n</m>:
              <md>
                <mrow> \frac{1}{3} T_n \amp = \frac{\Delta x}{3}\left(y_0 + 2 y_2 + 2 y_4 + \dots + 2 y_{2n-2} + y_{2n} \right)</mrow>
                <mrow> \frac{2}{3} M_n \amp = \frac{\Delta x}{3} \left(4y_1 + 4y_3 + 4y_5 + \dots + 4y_{2n-1} \right)</mrow>
              </md> 
              Summing them up, we get:
              <me>
                \frac{1}{3} T_n + \frac{2}{3} M_n = \frac{\Delta x}{3} \left(y_0 + 4 y_1 + 2 y_2 + 4 y_3 + 2 y_4 + \dots + 4 y_{2n-1} + y_{2n} \right) = S_{2n}
              </me>
            </p>
          </solution>
        </exercise>

        <exercise>
          <introduction>
            <p> Let <me>f(x) =
                \frac{1}{\sqrt{2\pi}}e^{-x^2/2}</me>. The function <m>f</m> is the probability
              density function of a normally distributed random variable with mean <m>0</m> and
              standard deviation <m>
                1</m>. The function <me>E = \int_0^x f(t)\,dt</me> can be used
              to compute probability that the variable lies within any given interval. Remember that <m>
              f(x)</m> is not integrable in elementary terms. </p>
          </introduction>
          <task>
            <statement>
              <p> Use your favorite graphing technology (e.g., Desmos, Geogebra, Wolfram Alpha) to
                find an upper bound for the absolute value of <me>
                  f^{(4)}(x) = \frac{1}{\sqrt{2\pi}}e^{-x^2/2}(x^4 - 6x^2 + 3)
                </me>
                on <m>[0,1]</m>. Include a graph in your submission. </p>
            </statement>
            <solution>
              <p> A graph of <m>f^{(4)}(x)</m> on <m>[0,1]</m> shows that it is decreasing on <m>
                [0,1]</m>. Its maximum value is <m>f^{(4)}(0) = \frac{3}{\sqrt{2\pi}} \approx 1.197</m>.
                Its minimum value is <m>f^{(4)}(1) = -\frac{2}{\sqrt{2\pi e}} -0.484</m>.
                So <m>|f^{(4)}(x)| \leq \frac{3}{\sqrt{2\pi}}</m> on <m>[0,1]</m>. </p>
              <image width="60%">
                <prefigure xmlns="https://prefigure.org"
                  label="exercise-erf-approximation-diagram">
                  <diagram dimensions="(500,300)" margins="5">
                    <definition>f(x)=1/sqrt(2*pi)*exp(-x^2/2)*(x^4-6*x^2+3)</definition>
                    <definition>NyuViolet="#57068c"</definition>
                    <coordinates bbox="(-1,-0.6,1,1.5)">
                      <grid-axes xlabel="x" ylabel="y"
                        hlabels="(-1,1,1)"
                        vlabels="(-0.6,0.2,1.4)"
                      />
                      <graph function="f" stroke="NyuViolet" />
                    </coordinates>
                  </diagram>
                </prefigure>
              </image>
            </solution>
          </task>
          <task>
            <statement>
              <p> find the number of subdivisions <m>n</m> needed to guarantee that <m>S_n</m> for <m>
                E(1)</m> is within <m>
                  \frac{1}{1000}</m> of the exact value. </p>
            </statement>
            <solution>
              <p> On <m>[0,1]</m> we have <m>\abs{f^{(4)}(x)} \leq
                  \frac{3}{\sqrt{2\pi}}</m>. So <me>\abs{ES_n} \leq \frac{3}{\sqrt{2\pi}} \cdot
                \frac{1}{180 n^4} = \frac{1}{60\sqrt{2\pi} n^4}.</me> To ensure that this is less
                than <m>
                  \frac{1}{1000}</m>, it suffices to ensure that <me>\frac{1}{60\sqrt{2\pi}
                  n^4} &lt; \frac{1}{1000}
                  \implies
                  n^4 &gt; \frac{1000}{60\sqrt{2\pi}}
                  \implies
                  n &gt; \sqrt[4]{\frac{1000}{60\sqrt{2\pi}}} \approx 2.15.</me> So we can take <m>
                n=4</m> (the first even number greater than this). 
              </p>

              <p>
                We have <me>S_4 \approx 0.341355487857</me>, while <url href="https://shorturl.at/UGVI8">Wolfram Alpha</url> tells me that <me>
                  E(1) = 0.341344746068543</me> So our approximation is quite accurate.
              </p>
            </solution>
          </task>
        </exercise>
      </exercises>
    </section>
  </article>
</pretext>
